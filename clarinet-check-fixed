#!/bin/bash
# Fixed clarinet check that filters out false positive errors from Clarinet 3.12.0

OUTPUT=$(/home/admin/.cargo/bin/clarinet check "$@" 2>&1)

# Remove all lines containing "expecting expression of type function"
FILTERED=$(echo "$OUTPUT" | grep -v "expecting expression of type function")

# Check if there are any remaining error lines
if echo "$FILTERED" | grep -q "^error:"; then
    echo "$FILTERED"
    exit 1
else
    echo "âœ” All contracts compiled successfully!"
    exit 0
fi
